samtools module loaded
Conda environment initialized

Inactive Modules:
  1) samtools/1.13

Due to MODULEPATH changes, the following have been reloaded:
  1) bzip2/1.0.8     2) ncurses/6.2     3) xz/5.2.5     4) zlib/1.2.11

The following have been reloaded with a version change:
  1) binutils/2.36.1 => binutils/2.37     3) gcc/10.3.0 => gcc/11.2.0
  2) curl/7.76.0 => curl/7.78.0           4) gcccore/10.3.0 => gcccore/11.2.0

Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2
Running FLAMES pipeline...
#### Input parameters:
{
  "comment": ["this is the default config for nanopore single cell long read data using 10x VDJ kit (5'end). use splice annotation in alignment. "],
  "pipeline_parameters": {
    "seed": [2022],
    "do_genome_alignment": [true],
    "do_isoform_identification": [true],
    "bambu_isoform_identification": [true],
    "do_read_realignment": [true],
    "do_transcript_quantification": [true]
  },
  "barcode_parameters": {
    "max_edit_distance": [2],
    "has_UMI": [true],
    "UMI_length": [10]
  },
  "isoform_parameters": {
    "generate_raw_isoform": [false],
    "max_dist": [2],
    "max_ts_dist": [100],
    "max_splice_match_dist": [10],
    "min_fl_exon_len": [40],
    "max_site_per_splice": [3],
    "min_sup_cnt": [5],
    "min_cnt_pct": [0.001],
    "min_sup_pct": [0.2],
    "bambu_trust_reference": [true],
    "strand_specific": [0],
    "remove_incomp_reads": [4],
    "downsample_ratio": [1]
  },
  "alignment_parameters": {
    "use_junctions": [true],
    "no_flank": [false]
  },
  "realign_parameters": {
    "use_annotation": [true]
  },
  "transcript_counting": {
    "min_tr_coverage": [0.4],
    "min_read_coverage": [0.4]
  }
} 
gene annotation: /data/gpfs/projects/punim0646/manveer/gencode.v43.basic.annotation.gtf 
genome fasta: /data/gpfs/projects/punim0646/manveer/gencode.v43.transcripts.fa 
input fastq: /data/gpfs/projects/punim0646/manveer/FLAMES_Q20_GridION_1000expCells/matched_reads.fastq.gz 
output directory: /data/gpfs/projects/punim0646/manveer/FLAMES_Q20_GridION_1000expCells 
directory containing minimap2: /home/mschauhan/.conda/envs/minimap2/bin 
#### Aligning reads to genome using minimap2
16:05:00 Thu Jun 22 2023 minimap2_align
sh: /usr/bin/modulecmd: No such file or directory
[M::mm_idx_gen::11.090*1.73] collected minimizers
[M::mm_idx_gen::12.828*2.27] sorted minimizers
[M::main::12.884*2.26] loaded/built the index for 252913 target sequence(s)
[M::mm_mapopt_update::13.277*2.22] mid_occ = 178
[M::mm_idx_stat] kmer size: 14; skip: 5; is_hpc: 0; #seq: 252913
[M::mm_idx_stat::13.509*2.20] distinct minimizers: 25309784 (30.21% are singletons); average occurrences: 5.808; average spacing: 2.978
[M::worker_pipeline::341.635*6.05] mapped 411851 sequences
[M::worker_pipeline::496.893*7.76] mapped 407886 sequences
[M::worker_pipeline::710.345*8.08] mapped 408989 sequences
[M::worker_pipeline::855.738*8.67] mapped 410210 sequences
[M::worker_pipeline::1044.459*8.69] mapped 412319 sequences
[M::worker_pipeline::1194.427*9.05] mapped 410073 sequences
[M::worker_pipeline::1195.214*9.05] mapped 25181 sequences
[M::main] Version: 2.17-r941
[M::main] CMD: /home/mschauhan/.conda/envs/minimap2/bin/minimap2 -ax splice -t 12 -k14 --secondary=no --seed 2022 --junc-bed /data/gpfs/projects/punim0646/manveer/FLAMES_Q20_GridION_1000expCells/tmp_splice_anno.bed12 --junc-bonus 1 -o /data/gpfs/projects/punim0646/manveer/FLAMES_Q20_GridION_1000expCells/tmp_align.sam /data/gpfs/projects/punim0646/manveer/gencode.v43.transcripts.fa /data/gpfs/projects/punim0646/manveer/FLAMES_Q20_GridION_1000expCells/matched_reads.fastq.gz
[M::main] Real time: 1195.741 sec; CPU: 10812.376 sec; Peak RSS: 16.229 GB
[bam_sort_core] merging from 10 files and 1 in-memory blocks...
[E::hts_open_format] Failed to open file "/data/gpfs/projects/punim0646/manveer/FLAMES_Q20_GridION_1000expCells/align2genome.0000.bam" : File exists
[E::hts_open_format] Failed to open file "/data/gpfs/projects/punim0646/manveer/FLAMES_Q20_GridION_1000expCells/align2genome.0001.bam" : File exists
[E::hts_open_format] Failed to open file "/data/gpfs/projects/punim0646/manveer/FLAMES_Q20_GridION_1000expCells/align2genome.0002.bam" : File exists
[E::hts_open_format] Failed to open file "/data/gpfs/projects/punim0646/manveer/FLAMES_Q20_GridION_1000expCells/align2genome.0003.bam" : File exists
[E::hts_open_format] Failed to open file "/data/gpfs/projects/punim0646/manveer/FLAMES_Q20_GridION_1000expCells/align2genome.0004.bam" : File exists
[E::hts_open_format] Failed to open file "/data/gpfs/projects/punim0646/manveer/FLAMES_Q20_GridION_1000expCells/align2genome.0005.bam" : File exists
[E::hts_open_format] Failed to open file "/data/gpfs/projects/punim0646/manveer/FLAMES_Q20_GridION_1000expCells/align2genome.0006.bam" : File exists
[bam_sort_core] merging from 10 files and 1 in-memory blocks...
16:44:13 Thu Jun 22 2023 find_isoform
--- Start generating read class files ---
[16:46:43] WARNING: src/learner.cc:553: 
  If you are loading a serialized model (like pickle in Python, RDS in R) generated by
  older XGBoost, please export the model by calling `Booster.save_model` from that version
  first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/latest/tutorials/saving_model.html

  for more details about differences between saving model and serializing.

[16:46:43] WARNING: src/learner.cc:553: 
  If you are loading a serialized model (like pickle in Python, RDS in R) generated by
  older XGBoost, please export the model by calling `Booster.save_model` from that version
  first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/latest/tutorials/saving_model.html

  for more details about differences between saving model and serializing.

[16:46:43] WARNING: src/learner.cc:553: 
  If you are loading a serialized model (like pickle in Python, RDS in R) generated by
  older XGBoost, please export the model by calling `Booster.save_model` from that version
  first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/latest/tutorials/saving_model.html

  for more details about differences between saving model and serializing.

[16:46:43] WARNING: src/learner.cc:553: 
  If you are loading a serialized model (like pickle in Python, RDS in R) generated by
  older XGBoost, please export the model by calling `Booster.save_model` from that version
  first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/latest/tutorials/saving_model.html

  for more details about differences between saving model and serializing.

[16:49:24] WARNING: src/learner.cc:553: 
  If you are loading a serialized model (like pickle in Python, RDS in R) generated by
  older XGBoost, please export the model by calling `Booster.save_model` from that version
  first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/latest/tutorials/saving_model.html

  for more details about differences between saving model and serializing.

[16:49:24] WARNING: src/learner.cc:553: 
  If you are loading a serialized model (like pickle in Python, RDS in R) generated by
  older XGBoost, please export the model by calling `Booster.save_model` from that version
  first, then load it back in current version. See:

    https://xgboost.readthedocs.io/en/latest/tutorials/saving_model.html

  for more details about differences between saving model and serializing.

Error: BiocParallel errors
  1 remote errors, element index: 1
  0 unevaluated and other errors
  first remote error:
Error in if (sum(labels) == length(labels) | sum(labels) == 0) {: missing value where TRUE/FALSE needed
In addition: Warning messages:
1: In base::system2(command = "which", args = c("samtools"), stdout = TRUE,  :
  running command ''which' samtools 2>&1' had status 1
2: In .merge_two_Seqinfo_objects(x, y) :
  The 2 combined objects have no sequence levels in common. (Use
  suppressWarnings() to suppress this warning.)
3: In .merge_two_Seqinfo_objects(x, y) :
  The 2 combined objects have no sequence levels in common. (Use
  suppressWarnings() to suppress this warning.)
4: There was 1 warning in `mutate()`.
â„¹ In argument: `annotatedJunction = (!is.na(match(uniqueJunctions,
  uniqueAnnotatedIntrons)))`.
Caused by warning in `.merge_two_Seqinfo_objects()`:
! The 2 combined objects have no sequence levels in common. (Use
  suppressWarnings() to suppress this warning.) 
5: In .merge_two_Seqinfo_objects(x, y) :
  The 2 combined objects have no sequence levels in common. (Use
  suppressWarnings() to suppress this warning.)
6: In .merge_two_Seqinfo_objects(x, y) :
  The 2 combined objects have no sequence levels in common. (Use
  suppressWarnings() to suppress this warning.)
7: In .merge_two_Seqinfo_objects(x, y) :
  The 2 combined objects have no sequence levels in common. (Use
  suppressWarnings() to suppress this warning.)
8: In .merge_two_Seqinfo_objects(x, y) :
  The 2 combined objects have no sequence levels in common. (Use
  suppressWarnings() to suppress this warning.)
9: In .merge_two_Seqinfo_objects(x, y) :
  The 2 combined objects have no sequence levels in common. (Use
  suppressWarnings() to suppress this warning.)
Execution halted
